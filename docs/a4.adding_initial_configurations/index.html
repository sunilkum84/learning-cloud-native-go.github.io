<!DOCTYPE html>
<html lang=&#34;en&#34; data-theme=&#34;&#34;>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<script type="text/javascript">/*<![CDATA[*/window.__chunkMapping={"main":["/main.ffef3bb9b735a46363b7.css","/main.3764c0bd2c849369accc.js"],"component---site-src-pages-index-jsc-4-f-f99":["/component---site-src-pages-index-jsc-4-f-f99.057e3cfa462e27633c4c.css","/component---site-src-pages-index-jsc-4-f-f99.df9e5e457af82081e710.js"],"component---theme-doc-legacy-page-9-e-7-ca5":[],"docsMetadata---docs-84-c-21e":["/docsMetadata---docs-84-c-21e.b0e6b0a50ea96404c294.js"],"component---theme-doc-legacy-item-031-769":["/component---theme-doc-legacy-item-031-769.1f1ce10374de019f5d3a.css","/component---theme-doc-legacy-item-031-769.0b7f62c1e394e830a24c.js"],"content---docs-a-11-implementing-restful-handlersb-98-549":["/content---docs-a-11-implementing-restful-handlersb-98-549.99f40a2b9cb85b9837ad.js"],"metadata---docs-a-11-implementing-restful-handlers-232-439":["/metadata---docs-a-11-implementing-restful-handlers-232-439.fd392f57ec33713ebfc2.js"],"content---docs-a-10-adding-initial-books-api-routese-9-d-5b0":["/content---docs-a-10-adding-initial-books-api-routese-9-d-5b0.9e1f5f4591e5c6e7f37c.js"],"metadata---docs-a-10-adding-initial-books-api-routes-233-f69":["/metadata---docs-a-10-adding-initial-books-api-routes-233-f69.c8fd04b0e0ac1ba72edb.js"],"content---docs-a-2-adding-initial-http-server-9-ce-c7a":["/content---docs-a-2-adding-initial-http-server-9-ce-c7a.8fd801c17fdbae8c278e.js"],"metadata---docs-a-2-adding-initial-http-server-84-f-748":["/metadata---docs-a-2-adding-initial-http-server-84-f-748.c8a42632ac62dddbf725.js"],"content---docs-a-overviewbb-1-a6f":["/content---docs-a-overviewbb-1-a6f.ee6283512d7d6c8b367e.js"],"metadata---docs-a-overview-20-c-750":["/metadata---docs-a-overview-20-c-750.d2b055b36698656b663f.js"],"content---docs-a-3-adding-initial-docker-filesf-0-a-0a0":["/content---docs-a-3-adding-initial-docker-filesf-0-a-0a0.5f0a506e389038e7d606.js"],"metadata---docs-a-3-adding-initial-docker-files-55-a-745":["/metadata---docs-a-3-adding-initial-docker-files-55-a-745.020d35ba010d72c905ac.js"],"content---docs-a-7-adding-db-docker-filef-8-f-b43":["/content---docs-a-7-adding-db-docker-filef-8-f-b43.7d553882cafdd4fc9b01.js"],"metadata---docs-a-7-adding-db-docker-fileb-76-4cf":["/metadata---docs-a-7-adding-db-docker-fileb-76-4cf.cff18a4ee6dfcb479d91.js"],"content---docs-a-4-adding-initial-configurations-4-e-7-5f2":["/content---docs-a-4-adding-initial-configurations-4-e-7-5f2.51c7aa0dd7ac22803846.js"],"metadata---docs-a-4-adding-initial-configurationsc-8-a-0cb":["/metadata---docs-a-4-adding-initial-configurationsc-8-a-0cb.5dfd9249af050c2590ad.js"],"content---docs-a-12-adding-validator-v-96-e-5-0ad":["/content---docs-a-12-adding-validator-v-96-e-5-0ad.3f9e069a9f9ea15a8103.js"],"metadata---docs-a-12-adding-validator-v-9812-cdf":["/metadata---docs-a-12-adding-validator-v-9812-cdf.b0b322f8f507343aa4b4.js"],"content---docs-a-9-adding-gormf-78-427":["/content---docs-a-9-adding-gormf-78-427.e1718ace8b16c4d085da.js"],"metadata---docs-a-9-adding-gorm-33-d-b05":["/metadata---docs-a-9-adding-gorm-33-d-b05.edae50c768904e1bc1e6.js"],"content---docs-a-1-creating-a-new-go-project-52-f-ae3":["/content---docs-a-1-creating-a-new-go-project-52-f-ae3.0978ff1733b97f6a9f26.js"],"metadata---docs-a-1-creating-a-new-go-project-428-7a6":["/metadata---docs-a-1-creating-a-new-go-project-428-7a6.df779b4c10da5b4cb5cb.js"],"content---docs-a-6-adding-zerolog-loggera-22-c20":["/content---docs-a-6-adding-zerolog-loggera-22-c20.8c4cedbd6a0af7579576.js"],"metadata---docs-a-6-adding-zerolog-loggerd-5-b-e7b":["/metadata---docs-a-6-adding-zerolog-loggerd-5-b-e7b.41cce9523a5c5764f125.js"],"content---docs-a-8-adding-initial-database-migrations-9-cf-d23":["/content---docs-a-8-adding-initial-database-migrations-9-cf-d23.a17582cf0a195f97f931.js"],"metadata---docs-a-8-adding-initial-database-migrations-937-1ae":["/metadata---docs-a-8-adding-initial-database-migrations-937-1ae.f0b657fee49df56f4e81.js"],"content---docs-indexc-37-eeb":["/content---docs-indexc-37-eeb.8317f66e2062b3498677.js"],"metadata---docs-index-5-b-7-7e4":["/metadata---docs-index-5-b-7-7e4.ba6d66c78bbed2a73092.js"],"content---docs-a-5-adding-chi-routerbb-4-1ff":["/content---docs-a-5-adding-chi-routerbb-4-1ff.1e50dc0651b3be30057a.js"],"metadata---docs-a-5-adding-chi-router-5-cd-243":["/metadata---docs-a-5-adding-chi-router-5-cd-243.74107b41c202626d0f33.js"]};/*]]>*/</script>

<title data-react-helmet="true">Adding initial configurations</title>

<meta data-react-helmet="true" charset="utf-8"/><meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" name="viewport" content="width=device-width"/><meta data-react-helmet="true" property="og:title" content="Adding initial configurations"/><meta data-react-helmet="true" name="description" content="If you remember the [code of initial HTTP server](a2.adding_initial_http_server.md), we have hard-coded the server port and timeout values with the code. Things like them should be configurable. So better extract them to a `config` package and use those config parameters in the code."/><meta data-react-helmet="true" property="og:description" content="If you remember the [code of initial HTTP server](a2.adding_initial_http_server.md), we have hard-coded the server port and timeout values with the code. Things like them should be configurable. So better extract them to a `config` package and use those config parameters in the code."/><meta data-react-helmet="true" property="og:url" content="https://learning-cloud-native-go.github.io/docs/a4.adding_initial_configurations"/><meta data-react-helmet="true" name="twitter:card" content="summary"/>

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"/>


<link rel="stylesheet" type="text/css" href="/main.ffef3bb9b735a46363b7.css" />

<link rel="stylesheet" type="text/css" href="/1.a45730dd06ad7b99ea51.css" />

<link rel="stylesheet" type="text/css" href="/36.74320c83b2875cdbe979.css" />

<link rel="stylesheet" type="text/css" href="/component---theme-doc-legacy-item-031-769.1f1ce10374de019f5d3a.css" />

</head>
<body >
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Learning Cloud Native Go"/><strong>Learning Cloud Native Go</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" label="Docs" position="right" href="/docs/index">Docs</a><a class="navbar__item navbar__link" href="https://github.com/learning-cloud-native-go/website" label="GitHub" position="right" target="_blank" rel="noopener noreferrer">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_16vC moon_1N64"></span></div><div class="react-toggle-track-x"><span class="toggle_16vC sun_3CZP"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"/></div><div class="navbar__search"><input type="search" id="search_input_react" placeholder="Search" aria-label="Search"/></div></div></div><div role="presentation" class="navbar__sidebar__backdrop"></div><div class="navbar__sidebar"><div class="navbar__sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="Learning Cloud Native Go"/><strong>Learning Cloud Native Go</strong></a></div><div class="navbar__sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" label="Docs" position="right" href="/docs/index">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="https://github.com/learning-cloud-native-go/website" label="GitHub" position="right" target="_blank" rel="noopener noreferrer">GitHub</a></li></ul></div></div></div></nav><div class="container container--fluid"><div class="row"><div class="col col--3"><div class="sidebar_Qb2S"><div class="menu menu--responsive"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_1uhT" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="#!">Documentation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/index">Overview</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Let&#x27;s Get It Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/a.overview">Building a Dockerized RESTful API application</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a1.creating_a_new_go_project">Creating a new Go project</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a2.adding_initial_http_server">Adding initial HTTP server</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a3.adding_initial_docker_files">Adding initial docker files</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/a4.adding_initial_configurations">Adding initial configurations</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a5.adding_chi_router">Adding Chi router</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a6.adding_zerolog_logger">Adding Zerolog logger</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a7.adding_db_docker_file">Adding DB docker file</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a8.adding_initial_database_migrations">Adding initial database migrations</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a9.adding_gorm">Adding GORM</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a10.adding_initial_books_api_routes">Adding initial books API routes</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a11.implementing_restful_handlers">Implementing RESTful handlers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/a12.adding_validator.v9">Adding Validator.v9</a></li></ul></li></ul></div></div></div><main class="col"><div><div class="padding-vert--lg"><div class="row"><div class="col"><div class="docItemContainer_3Gws"><header><h1 class="margin-bottom--lg">Adding initial configurations</h1></header><article><div class="markdown"><p>If you remember the <a href="/docs/a2.adding_initial_http_server">code of initial HTTP server</a>, we have hard-coded the server port and timeout values with the code. Things like them should be configurable. So better extract them to a <code>config</code> package and use those config parameters in the code.</p><blockquote><p>💭 To store configurations, we can use many formats like <code>.xml</code>, <code>.json</code>, <code>.env</code>, <code>.yaml</code>, <code>.toml</code> files or systems like <a href="https://etcd.io/"><code>etcd</code></a>, <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html">AWS Parameter Store</a>, <a href="https://cloud.google.com/deployment-manager/runtime-configurator/">GCP Runtime Configurator</a>. I chose <strong><code>.env</code> files</strong> to store configurations in here due to the simplicity of use.</p></blockquote><h2><a aria-hidden="true" class="anchor" id="using-environment-variables-for-configurations"></a><a aria-hidden="true" class="hash-link" href="#using-environment-variables-for-configurations">#</a>Using environment variables for configurations</h2><ul><li>Because of these configs should be loaded with Docker application start, we store them under <code>docker/app/.env</code>.</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-undefined codeBlock_19pQ" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">SERVER_PORT=8080</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">SERVER_TIMEOUT_READ=5s</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">SERVER_TIMEOUT_WRITE=10s</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">SERVER_TIMEOUT_IDLE=15s</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><ul><li>We can use <a href="https://docs.docker.com/compose/environment-variables/#the-env_file-configuration-option"><code>env_file</code> configuration option</a> on <code>docker-compose.yml</code> to set environment variables via an <code>.env</code> file on application start; (Line 5-6).</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-yml codeBlock_19pQ" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token key atrule">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token key atrule">context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> .</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token key atrule">dockerfile</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ./docker/app/Dockerfile</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token key atrule">env_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> ./docker/app/.env</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;8080:8080&quot;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><h2><a aria-hidden="true" class="anchor" id="populating-data-from-environment-variables"></a><a aria-hidden="true" class="hash-link" href="#populating-data-from-environment-variables">#</a>Populating data from environment variables</h2><blockquote><p>💭 Go standard library provides <a href="https://golang.org/pkg/os/#Getenv"><code>os.Getenv()</code></a> function to read each environment variable separately. But there are Go libraries like <a href="https://github.com/spf13/viper"><code>spf13/viper</code></a>, <a href="https://github.com/kelseyhightower/envconfig"><code>kelseyhightower/envconfig</code></a>, <a href="https://github.com/caarlos0/env"><code>caarlos0/env</code></a>, <a href="https://github.com/joeshaw/envdecode"><code>joeshaw/envdecode</code></a> to get data on multiple environment variables as a set, by populating a struct from environment variables. I chose <strong><a href="https://github.com/joeshaw/envdecode"><code>joeshaw/envdecode</code></a></strong> to use in here, due to its simplicity.</p></blockquote><ul><li>We need to run <code>go get github.com/joeshaw/envdecode</code> to download and install the package. This will update <code>go.mod</code> and <code>go.sum</code> files as well.</li><li>We can cache go modules by copying <code>go.mod</code> and <code>go.sum</code> files to Docker first and by running <code>go mod download</code> before copying all other files to Docker. So, let&#x27;s update <code>docker/app/Dockerfile</code> for this; (Line 6-8).</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-dockerfile codeBlock_19pQ" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">FROM golang:1.13-alpine as build-env</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">WORKDIR /myapp</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">RUN apk update &amp;&amp; apk add --no-cache gcc musl-dev git</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">COPY go.mod go.sum ./</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">RUN go mod download</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">COPY . .</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">RUN go build -ldflags &#x27;-w -s&#x27; -a -o ./bin/app ./cmd/app</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><ul><li>Let’s create a <code>config</code> package to get all configuration values once by adding <code>Conf</code> struct to map each configuration and <code>AppConfig()</code> function to get the populated struct. I save this code under <code>config/config.go</code>.</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-go codeBlock_19pQ" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">package</span><span class="token plain"> config</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;log&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;time&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;github.com/joeshaw/envdecode&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">type</span><span class="token plain"> Conf </span><span class="token keyword" style="color:rgb(127, 219, 202)">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    Server serverConf</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">type</span><span class="token plain"> serverConf </span><span class="token keyword" style="color:rgb(127, 219, 202)">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    Port         </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token plain">           </span><span class="token string" style="color:rgb(173, 219, 103)">`env:&quot;SERVER_PORT,required&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    TimeoutRead  time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Duration </span><span class="token string" style="color:rgb(173, 219, 103)">`env:&quot;SERVER_TIMEOUT_READ,required&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    TimeoutWrite time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Duration </span><span class="token string" style="color:rgb(173, 219, 103)">`env:&quot;SERVER_TIMEOUT_WRITE,required&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    TimeoutIdle  time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Duration </span><span class="token string" style="color:rgb(173, 219, 103)">`env:&quot;SERVER_TIMEOUT_IDLE,required&quot;`</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">AppConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">*</span><span class="token plain">Conf </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">var</span><span class="token plain"> c Conf</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(127, 219, 202)">:=</span><span class="token plain"> envdecode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">StrictDecode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(127, 219, 202)">!=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Fatalf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Failed to decode: %s&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;</span><span class="token plain">c</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><blockquote><p>💡 In here, we have created <code>Conf</code> struct with embedded struct <code>serverConf</code> to get initial server configs. So, when we need to add new configurations for DB in future, we can easily add another embedded struct for them to maintain simplicity and readability of the code.</p></blockquote><ul><li>Then, let&#x27;s update <code>cmd/app/main.go</code> to get configuration values via <code>AppConfig()</code> function; (Line 6,10,15 and 22–24).</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2QGZ"><pre class="prism-code language-go codeBlock_19pQ" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;fmt&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;log&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;net/http&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;myapp/config&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">func</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    appConf </span><span class="token operator" style="color:rgb(127, 219, 202)">:=</span><span class="token plain"> config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">AppConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    mux </span><span class="token operator" style="color:rgb(127, 219, 202)">:=</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">NewServeMux</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    mux</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">HandleFunc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;/&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> Greet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    address </span><span class="token operator" style="color:rgb(127, 219, 202)">:=</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Sprintf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;:%d&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> appConf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Printf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Starting server %s\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    s </span><span class="token operator" style="color:rgb(127, 219, 202)">:=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;</span><span class="token plain">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        Addr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">         address</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        Handler</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">      mux</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        ReadTimeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">  appConf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">TimeoutRead</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        WriteTimeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> appConf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">TimeoutWrite</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        IdleTimeout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">  appConf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">TimeoutIdle</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(127, 219, 202)">:=</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">ListenAndServe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(127, 219, 202)">!=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">nil</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(127, 219, 202)">!=</span><span class="token plain"> http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ErrServerClosed </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Fatal</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Server startup failed&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button></div></pre><ul><li>Rebuild and rerun the application. You should see the same <code>Hello World!</code> response on <code>localhost:8080</code>.</li></ul></div></article><div class="margin-top--xl margin-bottom--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/a3.adding_initial_docker_files"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« <!-- -->Adding initial docker files</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/a5.adding_chi_router"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Adding Chi router<!-- --> »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2wxO"><ul class="contents contents__left-border"><li><a href="#using-environment-variables-for-configurations" class="contents__link">Using environment variables for configurations</a></li><li><a href="#populating-data-from-environment-variables" class="contents__link">Populating data from environment variables</a></li></ul></div></div></div></div></div></main></div></div>
</div>

<script type="text/javascript" src="/runtime~main.95edd3bca754d73ca04e.js"></script>

<script type="text/javascript" src="/main.3764c0bd2c849369accc.js"></script>

<script type="text/javascript" src="/0.2faba3e04a049c4784b2.js"></script>

<script type="text/javascript" src="/1.367f965b18a556e392ff.js"></script>

<script type="text/javascript" src="/36.16a83d8efb7da314e508.js"></script>

<script type="text/javascript" src="/docsMetadata---docs-84-c-21e.b0e6b0a50ea96404c294.js"></script>

<script type="text/javascript" src="/component---theme-doc-legacy-item-031-769.0b7f62c1e394e830a24c.js"></script>

<script type="text/javascript" src="/content---docs-a-4-adding-initial-configurations-4-e-7-5f2.51c7aa0dd7ac22803846.js"></script>

<script type="text/javascript" src="/metadata---docs-a-4-adding-initial-configurationsc-8-a-0cb.5dfd9249af050c2590ad.js"></script>

</body>
</html>